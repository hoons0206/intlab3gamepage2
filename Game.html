<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>2P Conveyor</title>
  <link rel="stylesheet" href="style3.css">
  <style>
 
    .conveyor {
      position: absolute;
      left: 0;
      bottom: 50%;
      width: 100vw;
      height: 100px;
      overflow: hidden;
      white-space: nowrap;
    }
    .box {
      width: 70px;
      height: 70px;
      margin: 10px 120px; /* ✅ 1P와 동일하게 조정 */
      display: inline-block;
      border-radius: 1px;
      position: absolute;
      top: 10px;
      background-color: #111;
      color: white;
      font-size: 12px;
      text-align: center;
      line-height: 70px;
    }
  </style>
</head>
<body>

<div class="conveyor" id="conveyor"></div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
  import { getDatabase, ref, onChildAdded } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBpRJbMp9-REDACTED",
    authDomain: "twoplayergame-REDACTED.firebaseapp.com",
    databaseURL: "https://twoplayergame-REDACTED.firebaseio.com",
    projectId: "twoplayergame-REDACTED",
    storageBucket: "twoplayergame-REDACTED.appspot.com",
    messagingSenderId: "REDACTED",
    appId: "REDACTED"
  };

  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);
  const boxesRef = ref(database, 'boxes');

  const conveyor = document.getElementById('conveyor');
  const boxes = [];

  // ✅ 속도 보정: 화면 크기에 따라 상대 속도 계산
  const screenRatio = window.innerWidth / 375; // 기준 디바이스 너비: 375px
  const speed = 3 * screenRatio;

  onChildAdded(boxesRef, (data) => {
    const boxData = data.val();

    const boxEl = document.createElement('div');
    boxEl.className = 'box';

    // 내부 색상 저장
    boxEl.dataset.type = boxData.type;

    // 기본 외부 색상은 무채색
    boxEl.style.backgroundColor = '#111';

    // 시작 위치 왼쪽 밖
    let left = -70;
    boxEl.style.left = left + 'px';

    // 선택적으로 좌표 표시 (디버그용)
    // boxEl.innerText = boxData.type;

    conveyor.appendChild(boxEl);

    boxes.push({
      el: boxEl,
      left: left
    });
  });

  function animate() {
    boxes.forEach((box, index) => {
      box.left += speed;
      box.el.style.left = box.left + 'px';
    });

    requestAnimationFrame(animate);
  }

  animate();
</script>

</body>
</html>

