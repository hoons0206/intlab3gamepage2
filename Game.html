<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>2P Conveyor</title>
  <link rel="stylesheet" href="style3.css">
</head>
<body>

<div class="conveyor" id="conveyor"></div>


  <a class="back-button" href="About.html">뒤로가기</a>
<div id="color-sequence-display"></div>
<div class="buttons" style="text-align:center; margin-top: 20px;">
  <button class="start-button" data-type="type1">네모</button>
  <button class="start-button" data-type="type2">세모</button>
  <button class="start-button" data-type="type3">동그라미</button>
</div>
  
<!-- Firebase SDK - compat 방식으로 통일 -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyD4d7JvLj90ar0Q8o_AEXFTjhMZF-oI-DU",
    authDomain: "interaction-lab-3-c4513.firebaseapp.com",
    databaseURL: "https://interaction-lab-3-c4513-default-rtdb.firebaseio.com",
    projectId: "interaction-lab-3-c4513",
    storageBucket: "interaction-lab-3-c4513.appspot.com",
    messagingSenderId: "40397314576",
    appId: "1:40397314576:web:b6bbbeb99fd43bda508895"
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();
  const boxesRef = db.ref('boxes');

  const conveyor = document.getElementById('conveyor');
  const boxes = [];

  const screenRatio = window.innerWidth / 375;
  const speed = 3 * screenRatio;

  boxesRef.on('child_added', (data) => {
    const boxData = data.val();

    const boxEl = document.createElement('div');
    boxEl.className = 'box';
    boxEl.dataset.type = boxData.type;
    boxEl.style.backgroundColor = '#111';
    let left = -70;
    boxEl.style.left = left + 'px';
    conveyor.appendChild(boxEl);

    boxes.push({
      el: boxEl,
      left: left
    });
  });

  function animate() {
    boxes.forEach((box) => {
      box.left += speed;
      box.el.style.left = box.left + 'px';
    });
    requestAnimationFrame(animate);
  }

  animate();
</script>

</body>
</html>

