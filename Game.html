<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>2P Conveyor</title>
  <link rel="stylesheet" href="style3.css">
</head>
<body>

<div id="conveyor"></div>

  <a class="back-button" href="About.html">뒤로가기</a>
<div id="color-sequence-display"></div>
<div class="buttons" style="text-align:center; margin-top: 20px;">
  <button class="start-button" data-type="type1">네모</button>
  <button class="start-button" data-type="type2">세모</button>
  <button class="start-button" data-type="type3">동그라미</button>
</div>
  
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
  import { getDatabase, ref, onChildAdded } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-database.js";

  const firebaseConfig = {
      apiKey: "AIzaSyD4d7JvLj90ar0Q8o_AEXFTjhMZF-oI-DU",
      authDomain: "interaction-lab-3-c4513.firebaseapp.com",
      databaseURL: "https://interaction-lab-3-c4513-default-rtdb.firebaseio.com",
      projectId: "interaction-lab-3-c4513",
      storageBucket: "interaction-lab-3-c4513.appspot.com",
      messagingSenderId: "40397314576",
      appId: "1:40397314576:web:b6bbbeb99fd43bda508895"
    };

  const app = initializeApp(firebaseConfig);
  const database = getDatabase(app);
  const boxesRef = ref(database, 'boxes');

  const conveyor = document.getElementById('conveyor');
  const boxes = [];

  // ✅ 속도 보정: 화면 크기에 따라 상대 속도 계산
  const screenRatio = window.innerWidth / 375; // 기준 디바이스 너비: 375px
  const speed = 3 * screenRatio;

onChildAdded(boxesRef, (data) => {
  const boxData = data.val();

  const boxEl = document.createElement('div');
  boxEl.className = 'box show-color-' + boxData.type; // 색상 클래스 적용
  boxEl.dataset.type = boxData.type;
  let left = -70;
  boxEl.style.left = left + 'px';

  conveyor.appendChild(boxEl);

  boxes.push({
    el: boxEl,
    left: left
  });
});



  function animate() {
    boxes.forEach((box, index) => {
      box.left += speed;
      box.el.style.left = box.left + 'px';
    });

    requestAnimationFrame(animate);
  }

  animate();
</script>

</body>
</html>

